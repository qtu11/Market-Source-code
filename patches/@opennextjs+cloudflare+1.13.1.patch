diff --git a/node_modules/@opennextjs/cloudflare/dist/cli/build/bundle-server.js b/node_modules/@opennextjs/cloudflare/dist/cli/build/bundle-server.js
index 95a1a0a..705180b 100644
--- a/node_modules/@opennextjs/cloudflare/dist/cli/build/bundle-server.js
+++ b/node_modules/@opennextjs/cloudflare/dist/cli/build/bundle-server.js
@@ -81,6 +81,36 @@ export async function bundleServer(buildOpts, projectOpts) {
             shimRequireHook(buildOpts),
             inlineDynamicRequires(updater, buildOpts),
             setWranglerExternal(),
+            // Custom resolve plugin để fix aliases có dấu "/" và resolve jose
+            {
+                name: 'fix-next-aliases',
+                setup(build) {
+                    // Fix Next.js internal modules với dấu "/"
+                    build.onResolve({ filter: /^next\/dist\/compiled\/(node-fetch|ws|@ampproject\/toolbox-optimizer|edge-runtime)$/ }, (args) => {
+                        const aliasMap = {
+                            'next/dist/compiled/node-fetch': path.join(buildOpts.outputDir, "cloudflare-templates/shims/fetch.js"),
+                            'next/dist/compiled/ws': path.join(buildOpts.outputDir, "cloudflare-templates/shims/empty.js"),
+                            'next/dist/compiled/@ampproject/toolbox-optimizer': path.join(buildOpts.outputDir, "cloudflare-templates/shims/throw.js"),
+                            'next/dist/compiled/edge-runtime': path.join(buildOpts.outputDir, "cloudflare-templates/shims/empty.js"),
+                        };
+                        return { path: aliasMap[args.path] };
+                    });
+                    // Fix jose module từ jwks-rsa - resolve về jose ở root node_modules
+                    build.onResolve({ filter: /^jose$/ }, (args) => {
+                        try {
+                            // Tìm jose trong root node_modules thay vì nested one
+                            const josePath = require.resolve('jose', { 
+                                paths: [buildOpts.appPath, path.join(buildOpts.appPath, 'node_modules')] 
+                            });
+                            // Return path để esbuild bundle nó
+                            return { path: josePath };
+                        } catch (e) {
+                            // Nếu không tìm thấy, để esbuild tự resolve
+                            return undefined;
+                        }
+                    });
+                },
+            },
             fixRequire(updater),
             handleOptionalDependencies(optionalDependencies),
             patchInstrumentation(updater, buildOpts),
@@ -96,17 +126,9 @@ export async function bundleServer(buildOpts, projectOpts) {
             updater.plugin,
         ],
         external: ["./middleware/handler.mjs"],
+        // Aliases được xử lý bằng resolve plugin để tránh lỗi "Invalid alias name"
+        // Các aliases có dấu "/" sẽ được resolve trong plugin
         alias: {
-            // Workers have `fetch` so the `node-fetch` polyfill is not needed
-            "next/dist/compiled/node-fetch": path.join(buildOpts.outputDir, "cloudflare-templates/shims/fetch.js"),
-            // Workers have builtin Web Sockets
-            "next/dist/compiled/ws": path.join(buildOpts.outputDir, "cloudflare-templates/shims/empty.js"),
-            // The toolbox optimizer pulls severals MB of dependencies (`caniuse-lite`, `terser`, `acorn`, ...)
-            // Drop it to optimize the code size
-            // See https://github.com/vercel/next.js/blob/6eb235c/packages/next/src/server/optimize-amp.ts
-            "next/dist/compiled/@ampproject/toolbox-optimizer": path.join(buildOpts.outputDir, "cloudflare-templates/shims/throw.js"),
-            // The edge runtime is not supported
-            "next/dist/compiled/edge-runtime": path.join(buildOpts.outputDir, "cloudflare-templates/shims/empty.js"),
             // `@next/env` is used by Next to load environment variables from files.
             // OpenNext inlines the values at build time so this is not needed.
             "@next/env": path.join(buildOpts.outputDir, "cloudflare-templates/shims/env.js"),
